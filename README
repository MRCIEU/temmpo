# README #

## About TeMMPo ## 

*  https://www.temmpo.org.uk/

TeMMPo (Text Mining for Mechanism Prioritisation) is a web-based tool to enable researchers to identify the quantity of published evidence for specific mechanisms between an exposure and outcome. The tool identifies co-occurrence of MeSH headings in scientific publications to indicate papers that link an intermediate mechanism to either an exposure or an outcome.

TeMMPo is particularly useful when a specific lifestyle or dietary exposure is known to associate with a disease outcome, but little is known about the underlying mechanisms. Understanding these mechanisms may help develop interventions, sub-classify disease or establish evidence for causality. TeMMPo quantifies the body of published literature to establish which mechanisms have been researched the most, enabling these mechanisms to be subjected to systematic review.

This development was funded by the World Cancer Research Fund UK, the UK Medical Research Council and the University of Bristol.

## Development ##

We are using Vagrant for our Centos development environment.  It requires an additional plugin to mount the development source code cloned on your local machine.

# Set up development environment

vagrant plugin install vagrant-sshfs
git clone git@bitbucket.org:researchit/temmpo.git

cd temmpo/deploy
vagrant up
vagrant ssh

# Activate virtualenv
cd /srv/projects/temmpo/lib/dev/bin && source activate

# Move to source directory
cd /srv/projects/temmpo/lib/dev/src/temmpo

# Set up database tables and run any migrations
python manage.py migrate

# Create a super user
python manage.py createsuperuser --settings=temmpo.settings.dev

# Running tests:
cd /srv/projects/temmpo/lib/dev/bin && source activate
cd /srv/projects/temmpo/lib/dev/src/temmpo
python manage.py test tests/ --settings=temmpo.settings.dev

# Run the development server
cd /srv/projects/temmpo/lib/dev/bin && source activate
cd /srv/projects/temmpo/lib/dev/src/temmpo
python manage.py runserver 0.0.0.0:59099 --settings=temmpo.settings.dev

## Deployment ##

# Tag in git using fabric utility function

# Tag release, e.g. version 1.2
fab taggit:master,1.3,temmpo

# Move/update prod_stable branch 
fab taggit:master,prod_stable,temmpo

## Deployment helper functions

# Example deploy feature branch to development server
fab deploy:host="tmma-dev.ilrt.bris.ac.uk",env="dev",branch="demo_stable",merge_from="TMMA-155"
fab deploy:host="tmma-dev.ilrt.bris.ac.uk",env="dev",branch="demo_stable",merge_from="TMMA-155" -i /srv/projects/tmma/.ssh/id_rsa.pub -u tmma

# Example deploy to production and tag master with a numeric version number
fab deploy:host="tmma.ilrt.bris.ac.uk",env="prod",branch="prod_stable",tag=1.4,merge_from="master" -i /srv/projects/tmma/.ssh/id_rsa.pub -u tmma


# On Debian production environment, e.g.
cd /usr/local/projects/tmma/lib/prod/src/temmpo

# One off
git branch --set-upstream prod_stable origin/prod_stable

git pull

../../bin/python manage.py collectstatic --dry-run
../../bin/python manage.py collectstatic

../../bin/python manage.py migrate browser

## Installation ##

**TO BE REVIEWED**

See helper scripts in deploy/*

To create a site on the development server run the build_site.sh script 
or use the local_build_site.sh if working on a desktop
