{% extends "threecolumn.html" %}
{% load mptt_tags %}

{% block title %}TeMMPo: Select {{ type }} MeSH® terms{% endblock %}

{% block scripts %}
<!-- Not bad, but not check box style -->
<!-- <script src="{{ STATIC_URL }}js/tree.jquery.js"></script> 
<script>
var data = [
    {
        label: 'Human', id: 1,
        children: [
            { label: 'child1', id: 2 },
            { label: 'child2', id: 3 }
        ]
    },
    {
        label: 'node2', id: 4,
        children: [
            { label: 'child3', id: 5 }
        ]
    }
];
</script>-->

<!-- Too old dismissed -->
<!-- script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script -->
<!-- script src="{{ STATIC_URL }}js/jquery.xmltree.plugin.min.2.0.js"></script -->

<!-- jstree -->
<script src="{{ STATIC_URL }}js/jstree/jstree.min.js"></script>
<script>
  $(function() {
    var availableTags = [
      "ActionScript",
      "AppleScript",
      "Asp",
      "BASIC",
      "C",
      "C++",
      "Clojure",
      "COBOL",
      "ColdFusion",
      "Erlang",
      "Fortran",
      "Groovy",
      "Haskell",
      "Human",
      "Java",
      "JavaScript",
      "Lisp",
      "Perl",
      "PHP",
      "Python",
      "Ruby",
      "Scala",
      "Scheme"
    ];
    $( "#tags" ).autocomplete({
      source: availableTags
    });
  });
</script>

{% endblock %}

{% block styles %}
<!-- link rel="stylesheet" href="{{ STATIC_URL }}css/jqtree.css" / -->

<!-- link rel="stylesheet" href="{{ STATIC_URL }}css/xmlmenutree.css" / -->

<!-- link rel="stylesheet" href="{{ STATIC_URL }}css/xmltree.css" / -->

<!-- jsTree -->
<link rel="stylesheet" href="{{ STATIC_URL }}css/jstree/themes/default/style.min.css" />
{% endblock %}

{% block left-column %}
    <h2>Quick search</h2>

    {# TODO wire up search by term name form #}
    <form action="." method="post">
        {% csrf_token %}
        <label for="tags">Term</label>
        <input id="tags" name="tags" type="text" value="" />
        <button type="submit">Submit</button>
    </form>
{% endblock %}

{% block middle-column %}

    <h2>MeSH® trees</h2>

    <!-- Mesh Term tree families -->
    {% for node in root_nodes %}
        <ul class="link-list">
            <li><a href="{% url term_selector_by_family_url pk=form.instance.id tree_number=node.tree_number %}">{{ node.term }}</a></li>
        </ul>
    {% endfor %}

{% endblock %}

{% block right-column %}

    <h2>Select {{ selected_node }} <acronym title="Medical Subject Headings">MeSH®</acronym> terms</h2>

    <form action="." method="post">
        {% csrf_token %}

        {# form.as_p #} {# TODO: Wire up jquery tree (multi) select form widget #}

        <!-- div id="terms" data-url="{{ STATIC_URL }}js/mesh-sample.json"></div -->

        <!-- div id="terms"></div -->

        <!-- div id="xmlMenuTree"></div>  
        <script type="text/javascript">
            $(document).ready(function(){
                var options = {
                    xmlUrl: '{{ STATIC_URL }}menuTree.xml',
                    treePanelId: 'terms',
                    loadingText: 'Loading...',
                    loadingError: 'Error: Loading Error.',
                    initialExpanded: true,
                    toggleSpeed: 400,
                    storeState: true
                };
                $('#xmlMenuTree').xmltree(options);
            });
        </script -->
        <!-- js tree -->
        <div id="term_tree">
            <ul>
                {% recursetree nodes %}
                    <li>
                        {{ node.term }}
                        {% if not node.is_leaf_node %}
                            <ul class="children">
                                {{ children }}
                            </ul>
                        {% endif %}
                    </li>
                {% endrecursetree %}
            </ul>

        </div>
        <script>
        $(function () { $('#term_tree').jstree(
            {"plugins" : [ "checkbox" ],  //"wholerow", 
             "core" : 
                { 'multiple': false }
            }
            ); });
        // See: Ajax and JSON versions http://www.jstree.com/docs/json/
        // plugins http://www.jstree.com/plugins/
        </script>
        <button type="submit">Submit</button>

        <!-- <script>
        $('#terms').tree();

        $('#terms').tree({
             data: data
        });

        </script -->
    </form>
{% endblock %}